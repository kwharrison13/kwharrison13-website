---
import Base from '../layouts/Base.astro';
import { getCollection } from 'astro:content';

const essays = (await getCollection('essays')).sort(
  (a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime()
).slice(0, 4);

const portfolio = (await getCollection('portfolio')).slice(0, 4);
const books = (await getCollection('books')).slice(0, 6);
---

<Base>

<!-- HERO -->
<div class="hero">
  <div class="hero-left fade-up">
    <div class="hero-label">Research · Capital · Ideas</div>
    <h1>Mapping the <em>architecture</em> of compounding potential.</h1>
    <p class="hero-bio">
      I lead research at <strong>Contrary VC</strong>, where I study how technology, capital, and human systems compound over time. I write about AI disruption, venture markets, cities, theology, and the long arc of ideas.
    </p>
    <div class="hero-links">
      <a href="https://investing1012dot0.substack.com/" class="btn btn-primary" target="_blank" rel="noopener">Subscribe to Newsletter</a>
      <a href="https://twitter.com/kwharrison13" class="btn btn-secondary" target="_blank" rel="noopener">@kwharrison13</a>
    </div>
  </div>
  <div class="hero-right fade-up">
    <div class="hero-stat-block">
      <div class="hero-stat-label">Current Focus</div>
      <div class="hero-stat-value">AI disruption of vertical software — which moats survive, and which don't.</div>
    </div>
    <div class="hero-stat-block">
      <div class="hero-stat-label">Background</div>
      <div class="hero-stat-value">BYU · Cambridge · TCV · Solamere Capital · Amazon</div>
    </div>
    <div class="hero-stat-block">
      <div class="hero-stat-label">Interests</div>
      <div class="hero-stat-value">Venture capital · Urban policy · LDS theology · City building · History of ideas</div>
    </div>
  </div>
</div>

<!-- RECENT ESSAYS -->
<section class="section">
  <div class="section-header">
    <h2 class="section-title">Essays</h2>
    <span class="section-subtitle">— recent writing</span>
    <div class="section-rule"></div>
  </div>
  <div class="essay-grid">
    {essays.map((essay) => (
      <div class="essay-item fade-up">
        <div class="essay-meta">
          <span class="tag">{essay.data.tag}</span>
          <span class="essay-date">{new Date(essay.data.date).getFullYear()}</span>
        </div>
        <a href={`/essays/${essay.slug}`} class="essay-title">{essay.data.title}</a>
        <p class="essay-excerpt">{essay.data.excerpt}</p>
      </div>
    ))}
  </div>
  <a href="/essays" class="view-all">All Essays</a>
</section>

<!-- PORTFOLIO IDEAS -->
<section class="section">
  <div class="section-header">
    <h2 class="section-title">Portfolio Ideas</h2>
    <span class="section-subtitle">— companies &amp; theses worth watching</span>
    <div class="section-rule"></div>
  </div>
  <div class="portfolio-grid">
    {portfolio.map((item) => (
      <div class="portfolio-item fade-up">
        <div class="portfolio-stage tag-gold" style="display:inline-block;margin-bottom:10px;">{item.data.stage}</div>
        <div class="portfolio-name">{item.data.name}</div>
        <p class="portfolio-desc">{item.data.description}</p>
      </div>
    ))}
  </div>
  <a href="/portfolio" class="view-all">All Ideas</a>
</section>

<!-- BOOKSHELF -->
<section class="section">
  <div class="section-header">
    <h2 class="section-title">Bookshelf</h2>
    <span class="section-subtitle">— what I'm reading &amp; recommending</span>
    <div class="section-rule"></div>
  </div>
  <div class="books-grid">
    {books.map((book, i) => (
      <div class="book-item fade-up">
        <div class={`book-spine b${(i % 6) + 1}`}>
          <div class="book-spine-text">{book.data.title}</div>
        </div>
        <div class="book-author">{book.data.author}</div>
        {book.data.note && <div class="book-note">{book.data.note}</div>}
      </div>
    ))}
  </div>
  <a href="/bookshelf" class="view-all">Full Bookshelf</a>
</section>

</Base>

<style>
/* HERO */
.hero {
  padding: clamp(48px, 8vw, 96px) clamp(24px, 6vw, 96px) clamp(40px, 6vw, 72px);
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 64px;
  align-items: end;
  border-bottom: 1px solid var(--rule);
}
@media (max-width: 700px) {
  .hero { grid-template-columns: 1fr; gap: 32px; }
}
.hero-label {
  font-family: var(--font-mono);
  font-size: 11px;
  letter-spacing: 0.15em;
  text-transform: uppercase;
  color: var(--rust);
  margin-bottom: 16px;
}
.hero h1 {
  font-family: var(--font-display);
  font-size: clamp(40px, 5.5vw, 68px);
  font-weight: 700;
  line-height: 1.05;
  letter-spacing: -0.02em;
  margin-bottom: 24px;
}
.hero h1 em { font-style: italic; color: var(--rust); }
.hero-bio {
  font-size: 19px;
  line-height: 1.65;
  color: var(--ink-light);
  max-width: 520px;
}
.hero-bio strong { color: var(--ink); font-weight: 500; }
.hero-right { display: flex; flex-direction: column; gap: 28px; }
.hero-links { display: flex; gap: 16px; flex-wrap: wrap; margin-top: 28px; }
.hero-stat-block { border-left: 2px solid var(--rust); padding-left: 18px; }
.hero-stat-label {
  font-family: var(--font-mono);
  font-size: 10px;
  letter-spacing: 0.15em;
  text-transform: uppercase;
  color: var(--ink-muted);
  margin-bottom: 4px;
}
.hero-stat-value { font-family: var(--font-display); font-size: 15px; color: var(--ink); }

/* ESSAYS */
.essay-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 0;
}
@media (max-width: 700px) { .essay-grid { grid-template-columns: 1fr; } }
.essay-item {
  padding: 24px 0;
  border-bottom: 1px solid var(--rule);
}
.essay-item:nth-child(odd) { padding-right: 40px; border-right: 1px solid var(--rule); }
.essay-item:nth-child(even) { padding-left: 40px; }
@media (max-width: 700px) {
  .essay-item:nth-child(odd) { padding-right: 0; border-right: none; }
  .essay-item:nth-child(even) { padding-left: 0; }
}
.essay-item:hover .essay-title { color: var(--rust); }
.essay-meta { display: flex; align-items: center; gap: 12px; margin-bottom: 8px; }
.essay-date { font-family: var(--font-mono); font-size: 10px; color: var(--ink-muted); letter-spacing: 0.08em; }
.essay-title {
  font-family: var(--font-display);
  font-size: 20px;
  font-weight: 600;
  line-height: 1.25;
  letter-spacing: -0.01em;
  margin-bottom: 8px;
  transition: color 0.2s;
  text-decoration: none;
  color: var(--ink);
  display: block;
}
.essay-excerpt { font-size: 15px; color: var(--ink-muted); line-height: 1.6; }

/* PORTFOLIO */
.portfolio-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 1px;
  background: var(--rule);
  border: 1px solid var(--rule);
}
.portfolio-item { background: var(--cream); padding: 28px; transition: background 0.2s; }
.portfolio-item:hover { background: var(--cream-dark); }
.portfolio-name {
  font-family: var(--font-display);
  font-size: 20px;
  font-weight: 600;
  letter-spacing: -0.01em;
  margin-bottom: 8px;
}
.portfolio-desc { font-size: 15px; color: var(--ink-muted); line-height: 1.55; }

/* BOOKSHELF */
.books-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  gap: 28px;
}
.book-item { display: flex; flex-direction: column; gap: 10px; }
.book-spine {
  width: 100%;
  aspect-ratio: 2/3;
  background: var(--ink);
  display: flex;
  align-items: flex-end;
  padding: 16px;
  position: relative;
  overflow: hidden;
  transition: transform 0.2s;
}
.book-spine:hover { transform: translateY(-4px); }
.book-spine::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 4px;
  background: var(--rust);
}
.book-spine-text { font-family: var(--font-display); font-size: 14px; font-weight: 600; color: var(--cream); line-height: 1.3; }
.book-author { font-family: var(--font-mono); font-size: 11px; color: var(--ink-muted); letter-spacing: 0.05em; }
.book-note { font-size: 13px; color: var(--ink-light); font-style: italic; line-height: 1.5; }
.b1 { background: #2c3e50; }
.b2 { background: #4a3728; }
.b3 { background: #1a3a2a; }
.b4 { background: #3d2b4a; }
.b5 { background: #2a2a3d; }
.b6 { background: #3a2a1a; }
</style>
